# 图书商城系统功能流程图

## 系统架构概览

```
图书商城后台管理系统
├── 用户认证模块
├── 核心管理模块
│   ├── 用户管理
│   ├── 图书管理
│   ├── 分类管理
│   ├── 标签管理
│   └── 群聊管理
├── 数据统计模块
└── API接口模块
```

## 详细功能流程图

### 1. 用户登录流程
```
开始
  ↓
用户访问系统
  ↓
检查session是否存在
  ├── 已登录 → 跳转首页
  └── 未登录 → 显示登录页面
  ↓
用户输入用户名密码
  ↓
验证用户信息
  ├── 验证失败 → 显示错误信息
  └── 验证成功 → 
      ↓
检查用户角色权限
  ├── 普通用户 → 提示无权限
  └── 管理员/员工 → 
      ↓
设置session信息
  ↓
跳转至系统首页
```

### 2. 用户管理模块流程
```
用户管理
  ├── 用户分类管理
  │   ├── 管理员用户管理
  │   ├── 员工用户管理
  │   └── 普通用户管理
  ├── 用户操作流程
  │   ├── 新增用户
  │   │   └── 验证用户名唯一性 → 插入数据库 → 刷新列表
  │   ├── 编辑用户
  │   │   ├── 管理员：可编辑所有信息
  │   │   └── 员工：只能修改自己密码
  │   └── 删除用户
  │       └── 不能删除当前登录用户
  └── 用户搜索与分页
      ├── 按角色筛选
      ├── 按用户名搜索
      └── 分页显示
```

### 3. 图书管理模块流程
```
图书管理
  ├── 图书列表展示
  │   ├── 支持多条件搜索
  │   │   ├── 按分类筛选
  │   │   ├── 按状态筛选
  │   │   ├── 按标题搜索
  │   │   └── 按作者搜索
  │   └── 分页显示
  ├── 图书操作流程
  │   ├── 新增图书
  │   │   └── 填写完整信息 → 验证数据 → 保存数据库
  │   ├── 编辑图书
  │   │   └── 加载图书信息 → 修改数据 → 更新数据库
  │   ├── 删除图书
  │   │   └── 确认删除 → 删除记录
  │   └── 批量删除
  │       └── 选择多条记录 → 批量删除
  └── 图书状态管理
      └── 上架/下架切换
```

### 4. 分类管理模块流程
```
分类管理
  ├── 分类列表展示
  │   ├── 按状态筛选
  │   ├── 按名称搜索
  │   └── 按排序显示
  ├── 分类操作流程
  │   ├── 新增分类
  │   │   └── 输入分类信息 → 设置排序 → 保存
  │   ├── 编辑分类
  │   │   └── 修改分类信息 → 更新数据库
  │   └── 删除分类
  │       └── 确认删除 → 级联删除相关图书
  └── 分类状态管理
      └── 启用/禁用切换
```

### 5. 群聊管理模块流程
```
群聊管理
  ├── 群聊列表展示
  │   ├── 多条件搜索
  │   │   ├── 按群聊名称
  │   │   ├── 按群主名称
  │   │   ├── 按最大成员数
  │   │   └── 按状态筛选
  │   └── 分页显示
  ├── 群聊操作流程
  │   ├── 新增群聊
  │   │   └── 设置群聊信息 → 选择群主 → 保存
  │   ├── 编辑群聊
  │   │   └── 修改群聊信息 → 更新数据库
  │   └── 删除群聊
  │       └── 确认删除 → 级联删除群聊消息
  └── 群聊状态管理
      └── 启用/禁用切换
```

### 6. 数据统计流程
```
系统首页统计
  ├── 用户统计
  │   ├── 用户总数
  │   ├── 今日新增用户
  │   ├── 本周新增用户
  │   └── 本月新增用户
  ├── 图书统计
  │   ├── 图书总数
  │   └── 最新图书列表
  ├── 分类统计
  │   └── 分类总数
  └── 群聊统计
      └── 群聊总数
```

## 数据库关系图

```
users (用户表)
├── id (主键)
├── username (用户名)
├── password (密码)
├── role (角色)
└── status (状态)

categories (分类表)
├── id (主键)
├── name (分类名称)
└── status (状态)

books (图书表)
├── id (主键)
├── title (标题)
├── author (作者)
├── category_id (外键 → categories.id)
├── price (价格)
├── stock (库存)
└── status (状态)

tags (标签表)
├── id (主键)
└── name (标签名称)

book_tags (图书标签关联表)
├── book_id (外键 → books.id)
└── tag_id (外键 → tags.id)

comments (评论表)
├── book_id (外键 → books.id)
└── user_id (外键 → users.id)

chat_groups (群聊表)
├── id (主键)
├── group_name (群聊名称)
└── group_owner_id (外键 → users.id)

chat_messages (群聊消息表)
├── id (主键)
├── group_id (外键 → chat_groups.id)
└── user_id (外键 → users.id)
```

## 权限控制流程

```
权限验证流程
  ↓
用户访问页面
  ↓
检查session是否存在
  ├── 不存在 → 跳转登录页面
  └── 存在 → 检查用户角色
      ↓
根据角色判断权限
  ├── admin (管理员)
  │   └── 拥有所有权限
  ├── 员工
  │   ├── 可访问：用户管理、图书管理、分类管理、群聊管理
  │   └── 限制：只能编辑自己的用户信息
  └── 用户
      └── 无后台访问权限
```

## 系统特点

1. **完整的权限体系**：三级权限管理（管理员、员工、普通用户）
2. **丰富的搜索功能**：支持多条件组合搜索
3. **分页显示**：所有列表都支持分页
4. **批量操作**：支持批量删除等操作
5. **实时状态切换**：支持图书、分类、群聊的状态实时切换
6. **数据统计**：首页提供完整的系统数据概览
7. **响应式设计**：适配不同屏幕尺寸

## 技术栈

- **后端**：PHP + MySQL
- **前端**：HTML + CSS + JavaScript
- **数据库**：MySQL 8.0
- **架构**：MVC模式

这个系统是一个功能完整的图书商城后台管理系统，涵盖了用户管理、图书管理、分类管理、群聊管理等核心功能，具有良好的权限控制和用户体验。